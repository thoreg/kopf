# Kopf: Kubernetes Operators Framework

# First steps:

* [Installation](install.md)

# Tutorial:

* [Concepts](concepts.md)
* [Sample Problem](walkthrough/problem.md)
  * [Problem Statement](walkthrough/problem.md#problem-statement)
  * [Problem Solution](walkthrough/problem.md#problem-solution)
* [Environment Setup](walkthrough/prerequisites.md)
* [Custom Resources](walkthrough/resources.md)
  * [Custom Resource Definition](walkthrough/resources.md#custom-resource-definition)
  * [Custom Resource Objects](walkthrough/resources.md#custom-resource-objects)
* [Starting the operator](walkthrough/starting.md)
* [Creating the objects](walkthrough/creation.md)
* [Updating the objects](walkthrough/updates.md)
* [Diffing the fields](walkthrough/diffs.md)
  * [Old & New](walkthrough/diffs.md#old-new)
  * [Diffs](walkthrough/diffs.md#diffs)
* [Cascaded deletion](walkthrough/deletion.md)
* [Cleanup](walkthrough/cleanup.md)

# Resource handling:

* [Handlers](handlers.md)
  * [Events & Causes](handlers.md#events-causes)
  * [Registering](handlers.md#registering)
  * [Event-watching handlers](handlers.md#event-watching-handlers)
  * [State-changing handlers](handlers.md#state-changing-handlers)
  * [Resuming handlers](handlers.md#resuming-handlers)
  * [Field handlers](handlers.md#field-handlers)
  * [Sub-handlers](handlers.md#sub-handlers)
* [Daemons](daemons.md)
  * [Spawning](daemons.md#spawning)
  * [Termination](daemons.md#termination)
  * [Timeouts](daemons.md#timeouts)
  * [Safe sleep](daemons.md#safe-sleep)
  * [Postponing](daemons.md#postponing)
  * [Restarting](daemons.md#restarting)
  * [Deletion prevention](daemons.md#deletion-prevention)
  * [Resource fields access](daemons.md#resource-fields-access)
  * [Results delivery](daemons.md#results-delivery)
  * [Error handling](daemons.md#error-handling)
  * [Filtering](daemons.md#filtering)
  * [System resources](daemons.md#system-resources)
* [Timers](timers.md)
  * [Intervals](timers.md#intervals)
  * [Sharpness](timers.md#sharpness)
  * [Idling](timers.md#idling)
  * [Postponing](timers.md#postponing)
  * [Combined timing](timers.md#combined-timing)
  * [Errors in timers](timers.md#errors-in-timers)
  * [Results delivery](timers.md#results-delivery)
  * [Filtering](timers.md#filtering)
  * [System resources](timers.md#system-resources)
* [Arguments](kwargs.md)
  * [Forward compatibility kwargs](kwargs.md#forward-compatibility-kwargs)
  * [Retrying and timing](kwargs.md#retrying-and-timing)
  * [Parametrization](kwargs.md#parametrization)
  * [Operator configuration](kwargs.md#operator-configuration)
  * [Resource-related kwargs](kwargs.md#resource-related-kwargs)
  * [Resource-watching kwargs](kwargs.md#resource-watching-kwargs)
  * [Resource-changing kwargs](kwargs.md#resource-changing-kwargs)
  * [Resource daemon kwargs](kwargs.md#resource-daemon-kwargs)
  * [Resource admission kwargs](kwargs.md#resource-admission-kwargs)
* [Async/Await](async.md)
* [Loading and importing](loading.md)
* [Resource specification](resources.md)
* [Filtering](filters.md)
  * [Metadata filters](filters.md#metadata-filters)
  * [Field filters](filters.md#field-filters)
  * [Change filters](filters.md#change-filters)
  * [Value callbacks](filters.md#value-callbacks)
  * [Callback filters](filters.md#callback-filters)
  * [Callback helpers](filters.md#callback-helpers)
  * [Stealth mode](filters.md#stealth-mode)
* [Results delivery](results.md)
* [Error handling](errors.md)
  * [Temporary errors](errors.md#temporary-errors)
  * [Permanent errors](errors.md#permanent-errors)
  * [Regular errors](errors.md#regular-errors)
  * [Timeouts](errors.md#timeouts)
  * [Retries](errors.md#retries)
  * [Backoff](errors.md#backoff)
* [Scopes](scopes.md)
  * [Namespaces](scopes.md#namespaces)
  * [Cluster-wide](scopes.md#cluster-wide)
* [In-memory containers](memos.md)
  * [Resource memos](memos.md#resource-memos)
  * [Operator memos](memos.md#operator-memos)
  * [Custom memo classes](memos.md#custom-memo-classes)
  * [Limitations](memos.md#limitations)
* [In-memory indexing](indexing.md)
  * [Index declaration](indexing.md#index-declaration)
  * [Index structure](indexing.md#index-structure)
  * [Index content](indexing.md#index-content)
  * [Recipes](indexing.md#recipes)
  * [Conditional indexing](indexing.md#conditional-indexing)
  * [Errors in indexing](indexing.md#errors-in-indexing)
  * [Kwargs safety](indexing.md#kwargs-safety)
  * [Performance](indexing.md#performance)
  * [Guarantees](indexing.md#guarantees)
  * [Limitations](indexing.md#limitations)
* [Admission control](admission.md)
  * [Dependencies](admission.md#dependencies)
  * [Validation handlers](admission.md#validation-handlers)
  * [Mutation handlers](admission.md#mutation-handlers)
  * [Handler options](admission.md#handler-options)
  * [In-memory containers](admission.md#in-memory-containers)
  * [Admission warnings](admission.md#admission-warnings)
  * [Admission errors](admission.md#admission-errors)
  * [Webhook management](admission.md#webhook-management)
  * [Servers and tunnels](admission.md#servers-and-tunnels)
  * [Authenticate apiservers](admission.md#authenticate-apiservers)
  * [Debugging with SSL](admission.md#debugging-with-ssl)
  * [Custom servers/tunnels](admission.md#custom-servers-tunnels)
  * [System resource cleanup](admission.md#system-resource-cleanup)

# Operator handling:

* [Startup](startup.md)
* [Shutdown](shutdown.md)
* [Health-checks](probing.md)
  * [Liveness endpoints](probing.md#liveness-endpoints)
  * [Kubernetes probing](probing.md#kubernetes-probing)
  * [Probe handlers](probing.md#probe-handlers)
* [Authentication](authentication.md)
  * [Custom authentication](authentication.md#custom-authentication)
  * [Piggybacking](authentication.md#piggybacking)
  * [Credentials lifecycle](authentication.md#credentials-lifecycle)
* [Configuration](configuration.md)
  * [Startup configuration](configuration.md#startup-configuration)
  * [Logging formats and levels](configuration.md#logging-formats-and-levels)
  * [Logging events](configuration.md#logging-events)
  * [Synchronous handlers](configuration.md#synchronous-handlers)
  * [Networking timeouts](configuration.md#networking-timeouts)
  * [Finalizers](configuration.md#finalizers)
  * [Handling progress](configuration.md#handling-progress)
  * [Change detection](configuration.md#change-detection)
  * [Storage transition](configuration.md#storage-transition)
  * [Retrying of API errors](configuration.md#retrying-of-api-errors)
  * [Throttling of unexpected errors](configuration.md#throttling-of-unexpected-errors)
* [Peering](peering.md)
  * [Priorities](peering.md#priorities)
  * [Scopes](peering.md#scopes)
  * [Custom peering](peering.md#custom-peering)
  * [Standalone mode](peering.md#standalone-mode)
  * [Automatic peering](peering.md#automatic-peering)
  * [Multi-pod operators](peering.md#multi-pod-operators)
  * [Stealth keep-alive](peering.md#stealth-keep-alive)
* [Command-line options](cli.md)
  * [Scripting options](cli.md#scripting-options)
  * [Logging options](cli.md#logging-options)
  * [Scope options](cli.md#scope-options)
  * [Probing options](cli.md#probing-options)
  * [Peering options](cli.md#peering-options)
  * [Development mode](cli.md#development-mode)

# Toolkits:

* [Events](events.md)
  * [Handled objects](events.md#handled-objects)
  * [Other objects](events.md#other-objects)
  * [Events for events](events.md#events-for-events)
* [Hierarchies](hierarchies.md)
  * [Labels](hierarchies.md#labels)
  * [Nested labels](hierarchies.md#nested-labels)
  * [Owner references](hierarchies.md#owner-references)
  * [Names](hierarchies.md#names)
  * [Namespaces](hierarchies.md#namespaces)
  * [Adopting](hierarchies.md#adopting)
  * [3rd-party libraries](hierarchies.md#rd-party-libraries)
* [Operator testing](testing.md)
  * [Background runner](testing.md#background-runner)
* [Embedding](embedding.md)
  * [Manual execution](embedding.md#manual-execution)
  * [Manual orchestration](embedding.md#manual-orchestration)
  * [Custom event loops](embedding.md#custom-event-loops)
  * [Multiple operators](embedding.md#multiple-operators)

# Recipes:

* [Deployment](deployment.md)
  * [Docker image](deployment.md#docker-image)
  * [Cluster deployment](deployment.md#cluster-deployment)
  * [RBAC](deployment.md#rbac)
* [Continuity](continuity.md)
  * [Persistence](continuity.md#persistence)
  * [Restarts](continuity.md#restarts)
  * [Downtime](continuity.md#downtime)
* [Idempotence](idempotence.md)
* [Reconciliation](reconciliation.md)
  * [Event-driven reactions](reconciliation.md#event-driven-reactions)
  * [Regularly scheduled timers](reconciliation.md#regularly-scheduled-timers)
  * [Permanently running daemons](reconciliation.md#permanently-running-daemons)
  * [What to use when?](reconciliation.md#what-to-use-when)
* [Tips & Tricks](tips-and-tricks.md)
  * [Excluding handlers forever](tips-and-tricks.md#excluding-handlers-forever)
* [Troubleshooting](troubleshooting.md)
  * [`kubectl` freezes on object deletion](troubleshooting.md#kubectl-freezes-on-object-deletion)

# Developer Manual:

* [Minikube](minikube.md)
* [Contributing](contributing.md)
  * [Git workflow](contributing.md#git-workflow)
  * [Git conventions](contributing.md#git-conventions)
  * [DCO sign-off](contributing.md#dco-sign-off)
  * [Code style](contributing.md#code-style)
  * [Tests](contributing.md#tests)
  * [Reviews](contributing.md#reviews)
* [Architecture](architecture.md)
  * [Layered layout](architecture.md#layered-layout)
* [kopf package](packages/kopf.md)
  * [`register()`](packages/kopf.md#kopf.register)
  * [`execute()`](packages/kopf.md#kopf.execute)
  * [`daemon()`](packages/kopf.md#kopf.daemon)
  * [`timer()`](packages/kopf.md#kopf.timer)
  * [`index()`](packages/kopf.md#kopf.index)
  * [`configure()`](packages/kopf.md#kopf.configure)
  * [`LogFormat`](packages/kopf.md#kopf.LogFormat)
  * [`login_via_pykube()`](packages/kopf.md#kopf.login_via_pykube)
  * [`login_via_client()`](packages/kopf.md#kopf.login_via_client)
  * [`login_with_kubeconfig()`](packages/kopf.md#kopf.login_with_kubeconfig)
  * [`login_with_service_account()`](packages/kopf.md#kopf.login_with_service_account)
  * [`LoginError`](packages/kopf.md#kopf.LoginError)
  * [`ConnectionInfo`](packages/kopf.md#kopf.ConnectionInfo)
  * [`event()`](packages/kopf.md#kopf.event)
  * [`info()`](packages/kopf.md#kopf.info)
  * [`warn()`](packages/kopf.md#kopf.warn)
  * [`exception()`](packages/kopf.md#kopf.exception)
  * [`spawn_tasks()`](packages/kopf.md#kopf.spawn_tasks)
  * [`run_tasks()`](packages/kopf.md#kopf.run_tasks)
  * [`operator()`](packages/kopf.md#kopf.operator)
  * [`run()`](packages/kopf.md#kopf.run)
  * [`adopt()`](packages/kopf.md#kopf.adopt)
  * [`label()`](packages/kopf.md#kopf.label)
  * [`not_()`](packages/kopf.md#kopf.not_)
  * [`all_()`](packages/kopf.md#kopf.all_)
  * [`any_()`](packages/kopf.md#kopf.any_)
  * [`none_()`](packages/kopf.md#kopf.none_)
  * [`get_default_lifecycle()`](packages/kopf.md#kopf.get_default_lifecycle)
  * [`set_default_lifecycle()`](packages/kopf.md#kopf.set_default_lifecycle)
  * [`build_object_reference()`](packages/kopf.md#kopf.build_object_reference)
  * [`build_owner_reference()`](packages/kopf.md#kopf.build_owner_reference)
  * [`append_owner_reference()`](packages/kopf.md#kopf.append_owner_reference)
  * [`remove_owner_reference()`](packages/kopf.md#kopf.remove_owner_reference)
  * [`ErrorsMode`](packages/kopf.md#kopf.ErrorsMode)
  * [`AdmissionError`](packages/kopf.md#kopf.AdmissionError)
  * [`WebhookClientConfigService`](packages/kopf.md#kopf.WebhookClientConfigService)
  * [`WebhookClientConfig`](packages/kopf.md#kopf.WebhookClientConfig)
  * [`UserInfo`](packages/kopf.md#kopf.UserInfo)
  * [`WebhookFn`](packages/kopf.md#kopf.WebhookFn)
  * [`WebhookServer`](packages/kopf.md#kopf.WebhookServer)
  * [`WebhookK3dServer`](packages/kopf.md#kopf.WebhookK3dServer)
  * [`WebhookMinikubeServer`](packages/kopf.md#kopf.WebhookMinikubeServer)
  * [`WebhookNgrokTunnel`](packages/kopf.md#kopf.WebhookNgrokTunnel)
  * [`WebhookAutoServer`](packages/kopf.md#kopf.WebhookAutoServer)
  * [`WebhookAutoTunnel`](packages/kopf.md#kopf.WebhookAutoTunnel)
  * [`PermanentError`](packages/kopf.md#kopf.PermanentError)
  * [`TemporaryError`](packages/kopf.md#kopf.TemporaryError)
  * [`HandlerTimeoutError`](packages/kopf.md#kopf.HandlerTimeoutError)
  * [`HandlerRetriesError`](packages/kopf.md#kopf.HandlerRetriesError)
  * [`OperatorRegistry`](packages/kopf.md#kopf.OperatorRegistry)
  * [`get_default_registry()`](packages/kopf.md#kopf.get_default_registry)
  * [`set_default_registry()`](packages/kopf.md#kopf.set_default_registry)
  * [`OperatorSettings`](packages/kopf.md#kopf.OperatorSettings)
  * [`DiffBaseStorage`](packages/kopf.md#kopf.DiffBaseStorage)
  * [`AnnotationsDiffBaseStorage`](packages/kopf.md#kopf.AnnotationsDiffBaseStorage)
  * [`StatusDiffBaseStorage`](packages/kopf.md#kopf.StatusDiffBaseStorage)
  * [`MultiDiffBaseStorage`](packages/kopf.md#kopf.MultiDiffBaseStorage)
  * [`ProgressRecord`](packages/kopf.md#kopf.ProgressRecord)
  * [`ProgressStorage`](packages/kopf.md#kopf.ProgressStorage)
  * [`AnnotationsProgressStorage`](packages/kopf.md#kopf.AnnotationsProgressStorage)
  * [`StatusProgressStorage`](packages/kopf.md#kopf.StatusProgressStorage)
  * [`MultiProgressStorage`](packages/kopf.md#kopf.MultiProgressStorage)
  * [`SmartProgressStorage`](packages/kopf.md#kopf.SmartProgressStorage)
  * [`RawEvent`](packages/kopf.md#kopf.RawEvent)
  * [`RawBody`](packages/kopf.md#kopf.RawBody)
  * [`Status`](packages/kopf.md#kopf.Status)
  * [`Spec`](packages/kopf.md#kopf.Spec)
  * [`Meta`](packages/kopf.md#kopf.Meta)
  * [`Body`](packages/kopf.md#kopf.Body)
  * [`BodyEssence`](packages/kopf.md#kopf.BodyEssence)
  * [`ObjectReference`](packages/kopf.md#kopf.ObjectReference)
  * [`OwnerReference`](packages/kopf.md#kopf.OwnerReference)
  * [`Memo`](packages/kopf.md#kopf.Memo)
  * [`Index`](packages/kopf.md#kopf.Index)
  * [`Store`](packages/kopf.md#kopf.Store)
  * [`ObjectLogger`](packages/kopf.md#kopf.ObjectLogger)
  * [`LocalObjectLogger`](packages/kopf.md#kopf.LocalObjectLogger)
  * [`Diff`](packages/kopf.md#kopf.Diff)
  * [`DiffItem`](packages/kopf.md#kopf.DiffItem)
  * [`DiffOperation`](packages/kopf.md#kopf.DiffOperation)
  * [`Reason`](packages/kopf.md#kopf.Reason)
  * [`Patch`](packages/kopf.md#kopf.Patch)
  * [`DaemonStoppingReason`](packages/kopf.md#kopf.DaemonStoppingReason)
  * [`Resource`](packages/kopf.md#kopf.Resource)
  * [Submodules](packages/kopf.md#submodules)

# About Kopf:

* [Vision](vision.md)
* [Naming](naming.md)
* [Alternatives](alternatives.md)
  * [Metacontroller](alternatives.md#metacontroller)
  * [Side8’s k8s-operator](alternatives.md#side8-s-k8s-operator)
  * [CoreOS Operator SDK & Framework](alternatives.md#coreos-operator-sdk-framework)

# Indices and tables

* [Index](genindex.md)
* [Module Index](py-modindex.md)
* [Search Page](search.md)
